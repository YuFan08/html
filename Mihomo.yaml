mixed-port: 7890
ipv6: true
allow-lan: false
unified-delay: true
log-level: warning
mode: rule
disable-keep-alive: false
keep-alive-idle: 10
keep-alive-interval: 15
tcp-concurrent: true
geo-auto-update: true
geo-update-interval: 168
external-controller: 127.0.0.1:9090
external-controller-cors:
  allow-origins:
    - "*"
  allow-private-network: true
external-ui: ui
external-ui-url: https://github.com/MetaCubeX/metacubexd/archive/refs/heads/gh-pages.zip
profile:
  store-selected: true
  store-fake-ip: true
dns:
  enable: true
  respect-rules: true
  use-system-hosts: false
  listen: 127.0.0.1:1053
  ipv6: true
  enhanced-mode: fake-ip
  fake-ip-range: 198.18.0.1/16
  fake-ip-filter:
    - +.stun.*.*
    - +.nip.io
    - +.test.com
    - +.lan
    - +.local
    - msftconnecttest.com
    - msftncsi.com
    - time.*.com
    - time.*.gov
    - +.ntp.org.cn
    - +.bilibili.com
  
  # é»˜è®¤ DNSï¼šç”¨äºè§£æå›½å†…åŸŸåå’Œâ€œä»£ç†æœåŠ¡å™¨æœ¬èº«çš„åŸŸåâ€
  default-nameserver: 
    - 223.5.5.5
    - 119.29.29.29
  
  # ä¸»è¦ DNSï¼šé˜¿é‡Œ+è…¾è®¯ DoHï¼Œé€Ÿåº¦å¿«ï¼Œé˜²åŠ«æŒ
  nameserver:
    - https://dns.alidns.com/dns-query
    - https://doh.pub/dns-query
    
  # ä»£ç† DNSï¼šå½“æµé‡èµ°ä»£ç†æ—¶ï¼Œå¼ºåˆ¶è¿œç¨‹è§£æï¼ˆéå¸¸é‡è¦ï¼Œé˜²æ­¢ DNS æ±¡æŸ“ï¼‰
  proxy-server-nameserver:
    - https://1.1.1.1/dns-query
    - https://8.8.8.8/dns-query

  # ç­–ç•¥ï¼šæ˜ç¡®æŒ‡å®šå›½å†…åŸŸåèµ°é˜¿é‡Œ/è…¾è®¯
  nameserver-policy:
    "GEOSITE:CN": 
      - https://dns.alidns.com/dns-query
      - https://doh.pub/dns-query
    # å›½å¤–åŸŸåå¦‚æœä¸èµ°ä»£ç†ï¼Œå°è¯•ç”¨ Quad9 (æ¯” Google ç›´è¿ç¨å¾®ç¨³ä¸€ç‚¹ï¼Œä½†ä¸»è¦è¿˜æ˜¯é  fake-ip è¿œç¨‹è§£æ)
    "GEOSITE:geolocation-!cn":
      - https://dns.quad9.net/dns-query

tun:
  enable: true
  stack: mixed
  auto-route: true
  strict-route: true
  auto-detect-interface: true
  auto-mtu: true
  dns-hijack:
    - any:53
    - tcp://any:53
sniffer:
  enable: true
  force-dns-mapping: true
  parse-pure-ip: true
  override-destination: true
  sniff:
    HTTP:
      ports:
        - 80
        - 8080
        - 8880
        - 2052
        - 2082
        - 2086
        - 2095
    TLS:
      ports:
        - 443
        - 8443
        - 2053
        - 2083
        - 2087
        - 2096
proxy-providers:
  Trojan-Pool:
    type: file
    path: ./BPB.yaml
    health-check:
      enable: true
      interval: 300
      url: http://www.gstatic.com/generate_204

  Local-Pool:
    type: file
    path: ./LOCAL.yaml
    health-check:
      enable: true
      interval: 300
      url: http://www.gstatic.com/generate_204

proxy-groups:
  - name: "ğŸ“º YouTube"
    type: select
    use:
      - Local-Pool
  - name: "ğŸ‰ Plexing"
    type: select
    use:
      - Local-Pool
  - name: "ğŸ“½ï¸ Stream"
    type: select
    use:
      - Local-Pool
  - name: "ğŸˆè‡ªåŠ¨é“¾æ¥"
    type: select
    use:
      - Local-Pool
  - name: "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
    type: select
    use:
      - Local-Pool
  - name: "ğŸï¸ Japan"
    type: select
    use:
      - Trojan-Pool
    filter: "\U0001F4A6 22"
  - name: "ğŸŸ æ¼ç½‘ä¹‹é±¼"
    type: select
    use:
      - Local-Pool
  - name: "ğŸ Cloudflare"
    type: url-test
    use:
      - Trojan-Pool
    url: https://www.gstatic.com/generate_204
    interval: 300
    tolerance: 20

rules:
  - OR,((GEOSITE,google),(GEOSITE,openai),(GEOSITE,xai)),ğŸ“º YouTube
  - DOMAIN-KEYWORD,mmcdn,ğŸˆè‡ªåŠ¨é“¾æ¥
  #- PROCESS-NAME,PotPlayerMini64.exe,ğŸˆè‡ªåŠ¨é“¾æ¥
  #- PROCESS-NAME,vlc.exe,ğŸˆè‡ªåŠ¨é“¾æ¥
  - OR,((GEOSITE,cloudflare),(GEOSITE,microsoft),(GEOSITE,meta)),ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - OR,((DST-PORT,22),(DST-PORT,2222),(DOMAIN-KEYWORD,lol)),DIRECT
  - DOMAIN-KEYWORD,plex,ğŸ‰ Plexing
  - DOMAIN-KEYWORD,mgstage,ğŸï¸ Japan
  - GEOIP,lan,DIRECT,no-resolve
  - GEOSITE,CN,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,ğŸŸ æ¼ç½‘ä¹‹é±¼

ntp:
  enable: true
  server: time.cloudflare.com
  port: 123
  interval: 300
